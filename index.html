<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deli Sandwich Calculator - Mobile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Basic styling */
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { margin-bottom: 15px; font-size: 1.5em; text-align: center; }
    #sandwichStep { margin-bottom: 15px; font-size: 1.2em; text-align: center; }
    input[type=number] { width: 80px; font-size: 1.1em; padding: 5px; margin-bottom: 10px; text-align: center; }
    button { font-size: 1.1em; padding: 10px 20px; }


    /* Button wrapper for mobile */
    #buttonWrapper {
      display: flex;
      flex-direction: column; /* stack buttons vertically */
      align-items: center;
      width: 100%;
      margin-top: 10px;
    }
    #backBtn {
      margin-top: 10px;   /* space below Next button */
      display: none;       /* hidden initially */
    }
    #nextBtn, #backBtn {
      width: 80%;
      max-width: 300px;
    }

    #results { margin-top: 20px; font-weight: bold; font-size: 1.1em; white-space: pre-line; }
    #progress { margin-bottom: 10px; font-size: 0.9em; color: gray; text-align: center; }
    #progressBarContainer { width: 100%; background-color: #eee; height: 15px; border-radius: 8px; margin-bottom: 15px; }
    #progressBar { height: 100%; width: 0%; background-color: #4CAF50; border-radius: 8px; transition: width 0.3s; }
    * { box-sizing: border-box; } /* ensure padding doesn't break layout */
  </style>
</head>
<body>
  <h1>Deli Sandwich Calculator</h1>

  <div id="progress"></div>
  <div id="progressBarContainer">
    <div id="progressBar"></div>
  </div>

  <div id="sandwichStep"></div>
  <div id="inputButtonWrapper" style="display: flex; flex-direction: column; align-items: center; gap: 10px; width: 100%;">
  <input type="number" id="quantityInput" min="0" value="" style="width: 80%; max-width: 300px;" placeholder="Enter quantity">
  
  <div id="buttonWrapper" style="display: flex; flex-direction: column; width: 80%; max-width: 300px; gap: 10px;">
    <button id="nextBtn">Next</button>
    <button id="backBtn">Back</button>
  </div>
</div>


  <div id="results"></div>

  <script>
    // --- Data ---
    const sandwichKeys = [
      "hamSwissRye","tuna8Grain","chickenSaladSourdough","turkeyHavartiWrap","turkeySwissMultigrain",
      "turkeySwissPretzel","hamAmericanPretzel","eggSaladCroissant","tunaCroissant","chickenCaesarWrap",
      "chickenSaladCroissant","spicyRoastBeefCheddarPretzel","beefCheddarSourdough","cornedBeefSwissRye",
      "turkeyCheddarCroissant","bossSub","turkeyBossSub","bossNoSauce","taylorStreetSub"
    ];

    const sandwichNames = [
      "Ham & Swiss on Rye","Tuna Salad on 8 Grain","Chicken Salad Sourdough","Turkey & Havarti Wrap",
      "Turkey & Swiss on Multigrain","Turkey & Swiss on Pretzel","Ham & Yellow American on Pretzel",
      "Egg Salad Croissant","Tuna Salad Croissant","Chicken Caesar Wrap","Chicken Salad Croissant",
      "Spicy Roast Beef & Cheddar on Pretzel","Beef & Cheddar on Sourdough","Corned Beef & Swiss on Rye",
      "Turkey & Cheddar Croissant","BOSS Sub","Turkey BOSS Sub","BOSS No Sauce","Taylor Street Sub"
    ];

    const recipes = {
      hamSwissRye: { ham: 0.18, swiss: 2, rye: 2, tomatoes: 2 },
      tuna8Grain: { tunaSalad: 0.25, multigrain: 2, tomatoes: 2 },
      chickenSaladSourdough: { chickenSalad: 0.25, sourdough: 2, tomatoes: 0 },
      turkeyHavartiWrap: { turkey: 0.18, havarti: 1, wrap: 1, tomatoes: 2 },
      turkeySwissMultigrain: { turkey: 0.18, swiss: 2, multigrain: 2, tomatoes: 2 },
      turkeySwissPretzel: { turkey: 0.25, swiss: 1, pretzel: 1, tomatoes: 0 },
      hamAmericanPretzel: { ham: 0.25, american: 4, pretzel: 1, tomatoes: 0 },
      eggSaladCroissant: { eggSalad: 0.21, croissant: 1, cheddar: 1, tomatoes: 0 },
      tunaCroissant: { tunaSalad: 0.21, croissant: 1, cheddar: 1, tomatoes: 0 },
      chickenCaesarWrap: { grilledChicken: 1, provolone: 1, wrap: 1, tomatoes: 2 },
      chickenSaladCroissant: { chickenSalad: 0.21, croissant: 1, cheddar: 1, tomatoes: 0 },
      spicyRoastBeefCheddarPretzel: { roastBeef: 0.25, cheddar: 1, pretzel: 1, tomatoes: 0 },
      beefCheddarSourdough: { roastBeef: 0.18, cheddar: 2, sourdough: 2, tomatoes: 2 },
      cornedBeefSwissRye: { cornedBeef: 0.18, swiss: 2, rye: 2, tomatoes: 2 },
      turkeyCheddarCroissant: { turkey: 0.18, croissant: 1, cheddar: 1, tomatoes: 1 },
      bossSub: { ham: 0.43, turkey: 0.43, salamiSlices: 8, american: 4, italian: 1, tomatoes: 5 },
      turkeyBossSub: { turkey: 1.00, salamiSlices: 8, american: 4, italian: 1, tomatoes: 5 },
      bossNoSauce: { ham: 0.43, turkey: 0.43, salamiSlices: 8, american: 4, italian: 1, tomatoes: 5 },
      taylorStreetSub: { ham: 0.75, salami: 0.20, pepperoni: 0.60, provoloneSlices: 6, frenchBread: 1, tomatoes: 8 }
    };

    const conversions = {
      rye: { perWhole: 8, wholeName: "Bags of Rye" },
      sourdough: { perWhole: 8, wholeName: "Bags of Sourdough" },
      multigrain: { perWhole: 8, wholeName: "Bags of Multigrain" },
      croissant: { perWhole: 6, wholeName: "Bags of Croissants" },
      pretzel: { perWhole: 6, wholeName: "Bags of Pretzels" },
      tomatoes: { perWhole: 6, wholeName: "Tomatoes" }
    };

    let currentIndex = 0;
    let quantities = {};

    const sandwichStep = document.getElementById("sandwichStep");
    const quantityInput = document.getElementById("quantityInput");
    const backBtn = document.getElementById("backBtn");
    const nextBtn = document.getElementById("nextBtn");
    const progress = document.getElementById("progress");
    const progressBar = document.getElementById("progressBar");
    const resultsDiv = document.getElementById("results");

    // --- Stepper ---
    function updateStep() {
      sandwichStep.textContent = sandwichNames[currentIndex];
      quantityInput.value = quantities[sandwichKeys[currentIndex]] || ""; // blank if not entered
      quantityInput.focus();
      progress.textContent = `Sandwich ${currentIndex + 1} of ${sandwichKeys.length}`;
      backBtn.style.display = currentIndex === 0 ? "none" : "inline-block";
      nextBtn.textContent = currentIndex === sandwichKeys.length -1 ? "Calculate" : "Next";
      progressBar.style.width = ((currentIndex) / (sandwichKeys.length -1)) * 100 + "%";
    }

    // Enter key triggers Next
    quantityInput.addEventListener("keydown", function(e) {
      if (e.key === "Enter") nextBtn.click();
    });

    backBtn.addEventListener("click", () => {
      quantities[sandwichKeys[currentIndex]] = parseInt(quantityInput.value) || 0;
      if(currentIndex > 0) currentIndex--;
      updateStep();
    });

    nextBtn.addEventListener("click", () => {
      quantities[sandwichKeys[currentIndex]] = parseInt(quantityInput.value) || 0;
      if(currentIndex < sandwichKeys.length - 1) {
        currentIndex++;
        updateStep();
      } else {
        progressBar.style.width = "100%";
        calculateTotals();
      }
    });

    function capitalizeLabel(label) {
      return label.replace(/([A-Z])/g, ' $1')
                  .replace(/^./, str => str.toUpperCase())
                  .replace(/Salad/g, " Salad")
                  .replace(/Slices/g, " Slices")
                  .replace(/Bread/g, " Bread")
                  .trim();
    }

    // --- Calculation ---
    function calculateTotals() {
      let totals = {};
      let taylorQty = quantities["taylorStreetSub"] || 0;
      if(taylorQty > 0) {
        let adjQty = Math.ceil(taylorQty / 3) * 3;
        for(let ingredient in recipes["taylorStreetSub"]) {
          totals[ingredient] = (totals[ingredient] || 0) + recipes["taylorStreetSub"][ingredient] * (adjQty /3);
        }
      }

      for(let key of sandwichKeys) {
        if(key === "taylorStreetSub") continue;
        let qty = quantities[key] || 0;
        for(let ingredient in recipes[key]) {
          totals[ingredient] = (totals[ingredient] || 0) + recipes[key][ingredient] * qty;
        }
      }

      let meats = {}, cheeses = {}, bread = {}, tomatoes = {};
      for(let ingredient in totals) {
        let amount = totals[ingredient];
        if(["ham","turkey","roastBeef","cornedBeef","chickenSalad","eggSalad","tunaSalad","salami","pepperoni"].includes(ingredient)) {
          meats[ingredient] = amount.toFixed(2) + " lbs";
        } else if(ingredient === "grilledChicken") {
          meats[ingredient] = amount + " pieces";
        } else if(["american","havarti","cheddar","swiss","provoloneSlices","salamiSlices"].includes(ingredient)) {
          cheeses[ingredient] = Math.ceil(amount) + " slices";
        } else if(["rye","sourdough","multigrain","croissant","pretzel"].includes(ingredient)) {
          let whole = Math.ceil(amount / conversions[ingredient].perWhole);
          bread[ingredient] = amount + " (" + whole + " " + conversions[ingredient].wholeName + ")";
        } else if(ingredient === "frenchBread" || ingredient === "italian") {
          bread[ingredient] = amount;
        } else if(ingredient === "tomatoes") {
          let whole = Math.ceil(amount / conversions.tomatoes.perWhole);
          tomatoes["Tomatoes"] = amount + " slices (" + whole + " whole tomatoes)";
        }
      }

      // Build output
      let output = "MEATS:\n";
      for(let key in meats) output += capitalizeLabel(key) + ": " + meats[key] + "\n";
      output += "\nCHEESES:\n";
      for(let key in cheeses) output += capitalizeLabel(key) + ": " + cheeses[key] + "\n";
      output += "\nBREAD:\n";
      for(let key in bread) output += capitalizeLabel(key) + ": " + bread[key] + "\n";
      output += "\nTOMATOES:\n";
      for(let key in tomatoes) output += capitalizeLabel(key) + ": " + tomatoes[key] + "\n";

      resultsDiv.textContent = output;

      // --- Back button from results ---
      backBtn.style.display = "inline-block";
      backBtn.onclick = goBackFromResults;
    }

    function goBackFromResults() {
      sandwichStep.style.display = "block";
      quantityInput.style.display = "inline-block";
      nextBtn.style.display = "inline-block";
      progress.style.display = "block";
      document.getElementById("progressBarContainer").style.display = "block";
      resultsDiv.textContent = "";
      updateStep();
    }

    updateStep();
  </script>
</body>
</html>
